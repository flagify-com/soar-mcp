# 🚀 重磅发布：SOAR MCP Server - 让AI助手具备专业安全响应能力

## 📢 重要发布公告

**雾帜智能**正式发布开源项目 **SOAR MCP Server**，这是业内首个基于 Model Context Protocol (MCP) 的 SOAR 平台集成解决方案。通过该项目，我们让 Claude Desktop、Cherry Studio、Cursor 等AI客户端直接具备了专业的网络安全响应能力。

**🔗 项目地址：** https://github.com/flagify-com/soar-mcp

---

## 🌟 什么是 Model Context Protocol (MCP)？

Model Context Protocol (MCP) 是 Anthropic 公司推出的开放标准协议，旨在为AI助手提供安全、可控的外部工具调用能力。通过 MCP，AI助手可以：

- 🔧 **调用外部工具**：执行数据库查询、API调用、文件操作等
- 📊 **访问实时数据**：获取最新的业务数据和系统状态
- 🤖 **自动化工作流**：将复杂的多步骤操作串联起来
- 🛡️ **安全可控**：所有操作都在严格的权限控制下进行

MCP 正在成为连接AI与现实世界系统的标准桥梁，让AI助手从"对话工具"进化为"行动助手"。

---

## 🎯 为什么要用 MCP 驱动 SOAR？

### 传统 SOAR 平台的挑战

传统的安全编排、自动化和响应（SOAR）平台虽然功能强大，但在实际使用中面临诸多挑战：

- 🧠 **学习门槛高**：复杂的UI界面和配置流程
- ⚡ **响应速度慢**：需要人工导航到对应功能页面
- 🔄 **操作繁琐**：重复性任务需要多次点击
- 💼 **切换成本高**：不同安全工具间的操作方式差异大

### MCP + SOAR 的革命性优势

通过 MCP 协议驱动 SOAR 平台，我们实现了：

#### 🗣️ **自然语言操作**
```
用户："帮我检查IP地址 192.168.1.100 的威胁情报"
AI："正在执行IP信誉检查剧本，请稍候..."
```

#### ⚡ **秒级响应**
- 无需登录SOAR界面
- 无需寻找对应功能
- 一句话直接执行安全操作

#### 🤖 **智能化决策**
- AI理解安全语境和意图
- 自动选择最适合的安全剧本
- 智能填充执行参数

#### 🔄 **工作流整合**
- 在日常聊天中无缝集成安全操作
- 支持复杂的多步骤安全响应流程
- 与其他工具和数据源联动

---

## 🛡️ OctoMation：低代码编排自动化平台

**SOAR MCP Server** 专为 [OctoMation](https://github.com/flagify-com/OctoMation) 平台（雾帜智能安全编排自动化与响应产品HoneyGuide SOAR的社区免费版））设计。OctoMation 是由雾帜智能开发的功能强大的SOAR平台，具有以下特色：

### 🏗️ **完整的安全工具生态**
- 支持主流安全产品和平台集成
- 覆盖防火墙、EDR、SIEM、威胁情报等全品类
- 标准化的API接口和数据格式

### 📚 **丰富的安全剧本库**
- 预置大量实用的安全响应剧本
- 涵盖事件调查、威胁猎杀、应急响应等场景
- 可视化剧本编排，支持自定义扩展

### 🔄 **灵活的工作流引擎**
- 拖拽式剧本设计界面
- 支持条件分支、循环、并发等逻辑
- 实时执行监控和结果反馈

### 🌐 **开放的架构设计**
- 微服务架构，易于扩展和部署
- 支持私有化部署和云端部署
- 完整的API文档和SDK支持

---

## 🔗 SOAR MCP 与 OctoMation 联动方式

### 架构设计

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   AI 客户端      │    │   SOAR MCP      │    │  OctoMation     │
│ (Cherry Studio) │◄──►│    Server       │◄──►│   Platform      │
│ (Claude Desktop)│    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 核心功能

#### 📋 **剧本管理**
- `list_playbooks_quick` - 快速获取可用剧本列表
- `query_playbook_execution_params` - 查询剧本执行参数
- `execute_playbook` - 执行指定剧本

#### 📊 **执行监控**
- `query_playbook_execution_status` - 实时查询执行状态
- `query_playbook_execution_result` - 获取详细执行结果

#### 🔐 **安全认证**
- 基于Token的安全认证机制
- 完整的审计日志记录
- 细粒度的权限控制

### 联动效果

1. **🎯 精准理解**：AI理解用户的安全需求和意图
2. **🔍 智能匹配**：自动选择最适合的安全剧本和参数
3. **⚡ 快速执行**：通过MCP直接调用OctoMation API
4. **📈 实时反馈**：持续监控执行状态，智能解读结果
5. **🔄 持续优化**：基于执行结果提供改进建议

---

## 💡 典型应用场景

### 🔍 场景一：威胁情报查询
**用户输入：** "请帮我查一下这个IP 192.168.1.100 是否为恶意IP"

**AI响应流程：**
1. 理解用户意图 → IP威胁情报查询
2. 选择合适剧本 → "IP信誉检查剧本"
3. 自动填充参数 → src="192.168.1.100"
4. 执行安全剧本 → 调用多个威胁情报源
5. 解读执行结果 → 提供综合安全评估

### 🚨 场景二：安全事件响应
**用户输入：** "检测到可疑登录行为，用户账号：admin@company.com，来源IP：203.0.113.10"

**AI响应流程：**
1. 识别安全事件 → 异常登录事件
2. 启动响应剧本 → "账号异常登录调查剧本"
3. 并行执行操作 → IP信誉检查 + 账号行为分析 + 设备指纹识别
4. 综合风险评估 → 基于多维度数据判断威胁等级
5. 提出处置建议 → 账号锁定、IP封禁等措施

### 🔒 场景三：应急响应协调
**用户输入：** "发现恶意文件哈希：a1b2c3d4e5f6，需要全网查杀"

**AI响应流程：**
1. 启动应急剧本 → "恶意文件全网查杀剧本"
2. 多平台联动 → EDR + 防火墙 + 邮件安全网关
3. 实时监控进度 → 各平台查杀状态统计
4. 结果汇总分析 → 受影响主机列表和清理结果
5. 生成调查报告 → 包含时间线、影响范围、处置措施

---

## 🖼️ Cherry Studio 应用截图展示

### 截图1：剧本列表查询
```
用户: 请列出所有可用的安全剧本

Cherry Studio AI 回复:
📋 当前可用的 SOAR 剧本：

1. 🔍 IP信誉检查剧本 (ID: "1907203516548373")
   - 内部名称: ip_reputation_check
   - 显示名称: IP信誉检查剧本
   - 描述: 检查IP地址的威胁情报信息
   - 状态: ✅ 启用中

2. 🚨 恶意文件分析剧本 (ID: "1907203516548374")
   - 内部名称: malware_analysis
   - 显示名称: 恶意文件分析剧本
   - 描述: 对可疑文件进行多引擎检测分析
   - 状态: ✅ 启用中

3. 👤 账号异常行为调查剧本 (ID: "1907203516548375")
   - 内部名称: account_anomaly_investigation
   - 显示名称: 账号异常行为调查剧本
   - 描述: 分析用户账号的异常登录和行为模式
   - 状态: ✅ 启用中
```

### 截图2：智能剧本执行
```
用户: 帮我检查IP 192.168.1.100 的安全状况

Cherry Studio AI 回复:
🔍 正在为您执行IP信誉检查...

✅ 已启动IP信誉检查剧本
📊 执行参数:
   - 目标IP: 192.168.1.100
   - 检测深度: 标准模式
   - 威胁情报源: 6个主流平台

⏳ 正在查询中，预计需要15-30秒...

🎯 执行结果:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📍 IP地址: 192.168.1.100
🏷️  IP类型: 内网地址 (RFC 1918)
🌍 地理位置: 本地网络
🛡️  威胁等级: ✅ 安全 (0/6个平台报告威胁)

📋 详细检测结果:
   • VirusTotal: ✅ 清洁 (0/89)
   • AbuseIPDB: ✅ 未报告滥用
   • IPQualityScore: ✅ 信誉良好
   • Greynoise: ℹ️ 未发现扫描行为
   • Shodan: ℹ️ 未发现开放端口
   • AlienVault OTX: ✅ 无恶意标记

🎯 安全建议: 该IP地址为内网地址，未发现安全威胁
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 截图3：复杂安全事件处置
```
用户: 检测到异常登录：admin@company.com 从 203.0.113.10 登录，需要调查

Cherry Studio AI 回复:
🚨 检测到异常登录事件，正在启动安全调查...

🔄 已启动「账号异常行为调查剧本」
📊 调查参数:
   - 目标账号: admin@company.com
   - 来源IP: 203.0.113.10
   - 调查时间范围: 最近7天
   - 调查深度: 全面模式

⚡ 并行执行中:
   ├── 🔍 IP威胁情报查询... ✅ 完成
   ├── 👤 账号历史行为分析... ⏳ 进行中 (70%)
   ├── 🌍 地理位置异常检测... ✅ 完成
   ├── 🕐 登录时间模式分析... ✅ 完成
   └── 🖥️ 设备指纹比对... ⏳ 进行中 (45%)

🎯 初步调查结果:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  风险等级: 🔴 高风险

🔍 IP威胁情报:
   • 地理位置: 俄罗斯莫斯科 (与用户常用地相距8000公里)
   • 威胁评级: ⚠️ 中度威胁 (2/6平台报告可疑)
   • 历史记录: 近期出现在恶意活动中

👤 账号行为异常:
   • ✅ 密码正确 (未发现暴力破解)
   • ⚠️ 登录时间异常 (凌晨3点，非工作时间)
   • ⚠️ 地理位置跳跃 (上次登录:北京 → 本次:莫斯科)
   • ⚠️ 设备指纹不匹配 (未识别的浏览器和操作系统)

🚨 建议处置措施:
1. 🔒 立即锁定admin@company.com账号
2. 🚫 将203.0.113.10加入黑名单
3. 🔄 强制该账号重置密码
4. 📞 联系账号真实用户确认
5. 📊 启动详细的审计日志分析

是否需要我自动执行这些安全措施？
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 🔧 快速开始体验

### 1. 部署 SOAR MCP Server

```bash
# 克隆项目
git clone https://github.com/flagify-com/soar-mcp.git
cd soar-mcp

# 安装依赖
pip install -r requirements.txt

# 启动服务
python3 soar_mcp_server.py
```

### 2. 配置 MCP 客户端

在 Cherry Studio 中添加以下配置：

```json
{
  "mcpServers": {
    "soar-mcp": {
      "type": "http",
      "name": "soar-mcp",
      "description": "SOAR 安全编排平台集成",
      "url": "http://127.0.0.1:12345/mcp?token=your_token_here"
    }
  }
}
```

### 3. 开始安全响应之旅

在AI客户端中直接使用自然语言执行安全操作：
- "帮我查询这个IP的威胁情报"
- "分析这个文件哈希是否为恶意文件"
- "调查这个用户账号的异常行为"

---

## 🌟 项目价值与愿景

### 💡 **技术创新**
- **业内首创**：MCP + SOAR 的创新结合
- **开放标准**：基于Anthropic MCP协议
- **开源共享**：完全开源，促进社区发展

### 🎯 **用户价值**
- **降低门槛**：自然语言替代复杂UI操作
- **提升效率**：秒级响应取代分钟级操作
- **智能决策**：AI理解+专业工具执行

### 🔮 **未来愿景**
我们致力于打造**"AI驱动的安全运营中心"**，让每个安全从业者都能拥有AI助手，实现：
- 🤖 **7×24小时智能值守**
- ⚡ **自动化威胁响应**
- 🧠 **智能化决策支持**
- 🔄 **持续学习优化**

---

## 📞 联系我们

**雾帜智能** 专注于AI驱动的网络安全解决方案，致力于让安全更智能、更高效。

- 🌐 **官网：** https://flagify.com
- 📧 **邮箱：** code@wuzhi-ai.com
- 📱 **项目地址：** https://github.com/flagify-com/soar-mcp
- 💬 **技术交流：** 欢迎在GitHub提交Issue或PR

---

**让AI成为您的安全专家，让SOAR更智能！** 🚀